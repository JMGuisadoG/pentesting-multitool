#! /usr/bin/env python3

import dns, dns.resolver, sys

class dns_scan(object):

    def check(self):
        if len(sys.argv) != 5:
            print("Usage: pyhton3 pentesting-multitool.py DNS <file> <domain> <record>\n"
                  "It will create a file with the DNS record information of the specified domain.")
            exit()

    def run(self):
        domain = sys.argv[3]
        record = sys.argv[4]
        file = open(sys.argv[2], 'a')
        print("File opened\n"
              "Writing the information on the file..")
        ans = dns.resolver.query(domain, record)
        file.write(ans.response.to_text())
        print("Done.")
        file.close()

    def __init__(self):
        self.check()
        self.run()
        exit()
