#! /usr/bin/env python3

import sys, socket

class banner_grabbing(object):

    def check(self):
        if len(sys.argv) != 4:
            print("Usage: python3 pentesting-multitool bgrab <ip address> <ports>\n"
                  "(ports separated by \":\")")
            exit()

    def setting_vars(self):
        self.ip_address = sys.argv[2]
        self.ports = sys.argv[3].split(':')

    def run(self):

        for port in self.ports:
            try:
                sck = socket.socket()
                sck.settimeout(5)
                print("Connecting to %s in the port: %s" % (self.ip_address, str(port)))
                sck.connect((str(self.ip_address), int(port)))
                banner = sck.recv(1024)
                print(banner)
            except:
                print("Connection failed.")

    def __init__(self):
        self.check()
        self.setting_vars()
        self.run()
        print("All available banners grabbed.")