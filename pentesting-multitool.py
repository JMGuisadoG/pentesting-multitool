#! /usr/bin/env python3

import sys
from utility_scripts import dns_utility, whois_utility, shodan_utility, bannergrab_utility, flooder_utility, fuzzing_utility, mitm_utility

def main():
    if len(sys.argv) < 2:
        print("Usage: python3 pentesting-multitool.py <method>\n "
              "Type \"-h\" in <method> for show the avaliable methods.")

    elif sys.argv[1] == "-h":
        print("Available methods: \n"
              "DNS: Using it you can get information about a DNS record of a specific domain. \n"
              "whois: Using it you can get information about a domain. \n"
              "ssearch: Using it you can get information about the devices and services connected in a network. \n"
              "bgrab: Using it you can get information about some services in the specified ports and IP. \n"
              "flooder: Using it you can do a DOS Attack (Ping of death) or generate the PCAP file for do it.\n"
              "fuzzing: Using it you can do a fuzzing test and write a PCAP with results. Please read documentation for know about the PCAP format.\n")

    elif sys.argv[1] == "DNS":
        dns_utility.dns_scan()

    elif sys.argv[1] == "whois":
        whois_utility.whois_scan()

    elif sys.argv[1] == "ssearch":
        shodan_utility.shodan_search()

    elif sys.argv[1] == "bgrab":
        bannergrab_utility.banner_grabbing()

    elif sys.argv[1] == "flooder":
        flooder_utility.flooder_attack()

    elif sys.argv[1] == "fuzzing":
        fuzzing_utility.fuzzing_attack()

    elif sys.argv[1] == "mitm":
        mitm_utility.mitm_attack()

    else:
        print('Unknown function, please use -h for show the avaliable methods.')
        exit()

if __name__ == '__main__':
    main()